var canvas,ctx,width,height,row,col,size,margin,cells,button,loop,sizeTotal;function int(t){return parseInt(t)}function float(t){return parseFloat(t)}function nextGeneration(){for(var t=[],e=0;e<row;e++){t.push([]);for(var a=0;a<col;a++)t[e].push(lifeStatus(a,e))}return t}function lifeStatus(t,e){var a=val(t-1,e-1)+val(t,e-1)+val(t+1,e-1)+val(t-1,e)+val(t+1,e)+val(t-1,e+1)+val(t,e+1)+val(t+1,e+1);return val(t,e)?2==a||3==a?1:0:3==a?1:0}function val(t,e){return t<0||t>=col||e<0||e>=row?0:cells[e][t]}function drawCell(t,e){ctx.fillStyle="#000",ctx.fillRect(t*sizeTotal+margin,e*sizeTotal+margin,size,size)}function render(){ctx.clearRect(0,0,width,height);for(var t=0;t<row;t++)for(var e=0;e<col;e++)val(e,t)&&drawCell(e,t);cells=nextGeneration()}function setData(){var t;cells=[];for(var e=0;e<row;e++){t=[];for(var a=0;a<col;a++)t.push(Math.round(Math.random()));cells.push(t)}}function initVariable(){size=value($$("#size"),1,10),col=value($$("#col"),10,500),row=value($$("#row"),10,500),margin=value($$("#margin"),0,10),width=(sizeTotal=2*margin+size)*col,height=sizeTotal*row,console.log(height,width),canvas.height=height,canvas.width=width,setData()}function value(t,e,a){var l=int(t.value);return l=l<e?e:l,t.value=l>a?a:l,l>a?a:l}function reset(){loop&&clearInterval(loop),initVariable(),loop=setInterval(render,1e3/60)}function initLife(){canvas=$$("#life"),ctx=canvas.getContext("2d"),$$("#reset").addEvent("click",reset)}initLife();