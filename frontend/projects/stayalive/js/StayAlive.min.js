function Point(i,e){this.position={x:i,y:e}}function Player(i,e){this.position={x:i,y:e},this.size=6,this.shield={life:0,start:0,size:0}}function Mine(i,e){this.position={x:i,y:e},this.size=6+4*Math.random(),this.veriocity=1+.4*Math.random()}function Shield(i,e){this.position={x:i,y:e},this.size=8+4*Math.random(),this.life=!0}$$StayAlive=new function(){const i=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Phone/i.test(navigator.userAgent);let e,t,o,n=100,s=300;const a=new Player(4,5);let d,l,h,r,c,p=!1,y=[],f=[],u=[],g=new Shield(-1,0),w=2,x=2;const b={load:0,switcher:1,ready:"",play:"",bonus:"",bang:"",crash:""};let m,$,v,M,S,z,P,k,A,I,W;const E={x:0,y:0};function H(){b.load++,5===b.load&&(i?setInterval(q,1e3/30):setInterval(q,1e3/60),I.fadeOut(500,(function(){$$("#game").fadeIn(1500)})),b.switcher&&b.ready.play())}function T(i){const t=e.getBoundingClientRect();n=i.clientX-t.left,s=i.clientY-t.top}function L(i){1===i.touches.length&&(i.preventDefault(),n=i.touches[0].pageX-.5*(window.innerWidth-d),s=i.touches[0].pageY-.5*(window.innerHeight-l))}function C(i){1===i.touches.length&&(i.preventDefault(),n=i.touches[0].pageX-.5*(window.innerWidth-d),s=i.touches[0].pageY-.5*(window.innerHeight-l))}function B(i,e){return Math.sqrt((i.position.x-e.position.x)*(i.position.x-e.position.x)+(i.position.y-e.position.y)*(i.position.y-e.position.y))}function D(){const i=Math.min(l,d)/Math.max(l,d)*.5,e=Math.random();l<d?(E.x=e<i?d+1:Math.random()*d,E.y=E.x>d?Math.random()*l:-1):(E.x=e>i?d+1:Math.random()*d,E.y=E.x>d?Math.random()*l:-1)}function V(){d=i?window.innerWidth:window.innerWidth>800?800:window.innerWidth,l=i?window.innerHeight:window.innerHeight>500?500:window.innerHeight,e.width=d,e.height=l,i?(x=w*=1.5,o.css({margin:"0",height:l+"px",width:d+"px"})):o.css({marginTop:(window.innerHeight-l)/2+"px",marginLeft:(window.innerWidth-d)/2+"px",width:d+"px"})}function O(){!1===p&&(h=(new Date).getTime(),D(),p=!0,u=[],f=[],y=[],g=new Shield(E.x,E.y),m=0,x=w,a.position.x=n=50,a.position.y=s=50,v.hide(),W.hide(),u.push(new Point(a.position.x-1,a.position.y-1)),R("play"))}function X(){p&&(R("crash"),p=!1,a.shield.life=!1,Y(90),m=Math.ceil(m),p=!1,S.show(),v.show(),P.setText(m),k.setText($$.cookie("StayAliveHightScore")),parseInt($$.cookie("StayAliveHightScore")||0)<m&&$$.cookie("StayAliveHightScore",m),R("ready"))}function Y(i){for(let e=0;e<i;e++){const i=new Point(a.position.x,a.position.y);i.xVeocity=.8*Math.cos(3.14*Math.random())*(Math.random()+.5),i.yVeocity=.8*Math.cos(3.14*Math.random())*(Math.random()+.5),i.start=c,i.time=1100+500*Math.random(),f.push(i)}}function F(){b.switcher?(b.switcher=!1,$$.cookie("StayAliveSound","off"),b.ready.stop(),b.play.stop(),M.addClass("off")):(b.switcher=!0,$$.cookie("StayAliveSound","on"),b.ready.play(),M.removeClass("off"))}function R(i){if(b.switcher)switch(i){case"play":b.bonus.isMuted()||b.ready.fadeWith(b.play,500),b.ready.isMuted()||b.bonus.fadeWith(b.play,500);break;case"ready":b.bonus.isMuted()||b.play.fadeWith(b.ready,500),b.play.isMuted()||b.bonus.fadeWith(b.ready,500);break;case"bonus":b.play.fadeWith(b.bonus,500);break;case"bang":b.bang.stop(),b.bang.play();break;case"crash":b.crash.play()}}function q(){t.clearRect(0,0,d,l),c=(new Date).getTime(),a.position.x+=.14*(n-a.position.x),a.position.y+=.14*(s-a.position.y),D(),Math.random()>.7||y.push(new Mine(E.x,E.y)),g.life||Math.random()>.001||(D(),g=new Shield(E.x,E.y));for(var i=0;i<y.length;i++)(y[i].position.x<-10||y[i].position.y>l+10)&&y.splice(i,1)||(y[i].position.x-=y[i].veriocity*x,y[i].position.y+=y[i].veriocity*x,t.fillStyle="#B20000",t.beginPath(),t.arc(y[i].position.x,y[i].position.y,y[i].size/2,0,2*Math.PI,!0),t.closePath(),t.fill());u.push(new Point(a.position.x,a.position.y)),u.length<50||u.shift();for(i=0;i<f.length;i++)f[i].position.x+=f[i].xVeocity-x,f[i].position.y+=f[i].yVeocity+x,(f[i].position.x<-10||f[i].position.y>l+10||c-f[i].start>f[i].time)&&f.splice(i,1)||(t.fillStyle="#E6E6E6",t.beginPath(),t.arc(f[i].position.x,f[i].position.y,1,0,2*Math.PI,!0),t.closePath(),t.fill());if(g.position.x-=x,g.position.y+=x,g.position.x<-10||g.position.y>l+10)g.life=!1;else if(g.life){t.fillStyle="rgba(123, 11, 175, .1)";for(i=0;i<g.size;i+=.5)t.beginPath(),t.arc(g.position.x,g.position.y,i,0,2*Math.PI,!0),t.closePath(),t.fill()}if(p){m+=.5,x+=2e-4,g.life&&B(a,g)<a.size+g.size&&(a.shield.life=!0,a.shield.size=60,g.life=!1,R("bonus")),(a.position.x<6||a.position.y<6||a.position.x>d-6||a.position.y>l-26)&&X();for(i=0;i<y.length;i++)if(a.shield.life&&B(a,y[i])<a.size+y[i].size/2+20)y.splice(i,1),m+=10,Y(10),R("bang");else if(B(a,y[i])<a.size+y[i].size/2){X();break}if(a.shield.life){a.shield.size-=.2;const e=Math.min(a.shield.size,40);for(i=2;i<e;i++)t.fillStyle="rgba(123, 11, 175, 0.02)",t.beginPath(),t.arc(a.position.x,a.position.y,i+8,0,2*Math.PI,!0),t.closePath(),t.fill();a.shield.size<1&&(a.shield.life=!1,R("play"))}t.strokeStyle=a.shield.life?"rgba(123, 11, 175, 0.5)":"rgba(41, 163, 163, 0.6)";const e=[];for(i=0;i<u.length;i++)u[i].position.x-=x,u[i].position.y+=x,e.push(u[i].position.x),e.push(u[i].position.y);t.beginPath(),t.moveTo(e[0],e[1]),t.curve(e,.4,10,0),t.stroke(),t.lineWidth=2,t.stroke(),t.fillStyle=a.shield.life?"rgba(123, 11, 175, 0.1)":"rgba(41, 163, 163, .1)";for(i=0;i<a.size+1;i+=.5)t.beginPath(),t.arc(a.position.x,a.position.y,i,0,2*Math.PI,!0),t.closePath(),t.fill();A.setText("Score: "+m.toFixed()+" Time "+((c-h)/1e3).toFixed(1))}r=c}this.init=function(){o=$$("#game"),$=$$("#playGame"),v=$$("#gameInfo"),M=$$("#gameSound"),S=$$("#gover"),z=$$("#yourscore"),P=$$("#yourcs"),k=$$("#bestcs"),A=$$("#time"),W=$$("#textInfo"),e=$$("#StayAlive"),I=$$("#load"),e&&e.getContext&&(V(),t=e.getContext("2d"),window.addEventListener("resize",V),e.addEventListener("mousemove",T),$.addEventListener("click",O),e.addEventListener("touchstart",L,!1),document.addEventListener("touchmove",C,!1),M.addEventListener("click",F),k.setText($$.cookie("StayAliveHightScore")||0),b.ready=new buzz.sound("/assets/stayalive/sound/ready",{formats:["mp3","ogg"]}),b.play=new buzz.sound("/assets/stayalive/sound/play",{formats:["mp3","ogg"]}),b.bonus=new buzz.sound("/assets/stayalive/sound/bonus",{formats:["mp3","ogg"],volume:10}),b.bang=new buzz.sound("/assets/stayalive/sound/bang",{formats:["mp3","ogg"]}),b.crash=new buzz.sound("/assets/stayalive/sound/crash",{formats:["mp3","ogg"]}),b.ready.load().loop().bind("loadeddata",H),b.play.load().loop().bind("loadeddata",H),b.bonus.load().loop().bind("loadeddata",H),b.bang.load().bind("loadeddata",H),b.crash.load().bind("loadeddata",H),"off"===$$.cookie("StayAliveSound")&&(b.switcher=0,M.addClass("off")))}},$$StayAlive.init();