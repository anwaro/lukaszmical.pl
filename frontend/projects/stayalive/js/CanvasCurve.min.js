CanvasRenderingContext2D.prototype.curve=function(n,r,t,e){r="number"==typeof r?r:.5,t=t||25;var h,o,u=(n.length-2)*t+2+(e?2*t:0),a=0,f=new Float32Array(u),s=n.length,i=new Float32Array(4*(t+2)),l=4;for(h=n.slice(0),e?(h.unshift(n[s-1]),h.unshift(n[s-2]),h.push(n[0],n[1])):(h.unshift(n[1]),h.unshift(n[0]),h.push(n[s-2],n[s-1])),i[0]=1,o=1;o<t;o++){var p=o/t,v=p*p,g=v*p,c=2*g,y=3*v;i[l++]=c-y+1,i[l++]=y-c,i[l++]=g-2*v+p,i[l++]=g-v}function w(n,e,h){for(var o=2;o<h;o+=2)for(var u=n[o],s=n[o+1],i=n[o+2],l=n[o+3],p=(i-n[o-2])*r,v=(l-n[o-1])*r,g=(n[o+4]-u)*r,c=(n[o+5]-s)*r,y=0;y<t;y++){var w=y<<2,A=e[w],C=e[w+1],F=e[w+2],b=e[w+3];f[a++]=A*u+C*i+F*p+b*g,f[a++]=A*s+C*l+F*v+b*c}}for(i[++l]=1,w(h,i,s),e&&((h=[]).push(n[s-4],n[s-3],n[s-2],n[s-1]),h.push(n[0],n[1],n[2],n[3]),w(h,i,4)),s=e?0:n.length-2,f[a++]=n[s],f[a]=n[s+1],o=0,s=f.length;o<s;o+=2)this.lineTo(f[o],f[o+1]);return f};