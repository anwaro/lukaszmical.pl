var canvas,ctx,width,height,row,col,size,margin,cells,button,loop,sizeTotal;function int(t){return parseInt(t)}function float(t){return parseFloat(t)}function nextGeneration(){for(var t=[],a=0;a<row;a++){t.push([]);for(var e=0;e<col;e++)t[a].push(lifeStatus(e,a))}return t}function lifeStatus(t,a){var e=val(t-1,a-1)+val(t,a-1)+val(t+1,a-1)+val(t-1,a)+val(t+1,a)+val(t-1,a+1)+val(t,a+1)+val(t+1,a+1);return val(t,a)?2==e||3==e?1:0:3==e?1:0}function val(t,a){return t<0||t>=col||a<0||a>=row?0:cells[a][t]}function drawCell(t,a){ctx.fillStyle="#000",ctx.fillRect(t*sizeTotal+margin,a*sizeTotal+margin,size,size)}function render(){ctx.clearRect(0,0,width,height);for(var t=0;t<row;t++)for(var a=0;a<col;a++)val(a,t)&&drawCell(a,t);cells=nextGeneration()}function setData(){var t;cells=[];for(var a=0;a<row;a++){t=[];for(var e=0;e<col;e++)t.push(Math.round(Math.random()));cells.push(t)}}function initVariable(){size=value($$("#size"),1,30),col=value($$("#col"),10,500),row=value($$("#row"),10,500),margin=value($$("#margin"),0,30),width=(sizeTotal=2*margin+size)*col,height=sizeTotal*row,canvas.height=height,canvas.width=width,setData()}function value(t,a,e){var l=int(t.value);return l=l<a?a:l,t.value=l>e?e:l,l>e?e:l}function reset(){loop&&clearInterval(loop),initVariable(),loop=setInterval(render,1e3/60)}function initLife(){canvas=$$("#life"),ctx=canvas.getContext("2d"),$$("#reset").addEvent("click",reset)}initLife();