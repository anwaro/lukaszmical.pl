var n,a,o,u,f,i,l,v,c,r,$;function h(){for(var r,t,e,n=[],a=0;a<f;a++){n.push([]);for(var o=0;o<i;o++)n[a].push((e=void 0,e=s((r=o)-1,(t=a)-1)+s(r,t-1)+s(r+1,t-1)+s(r-1,t)+s(r+1,t)+s(r-1,t+1)+s(r,t+1)+s(r+1,t+1),s(r,t)?2==e||3==e?1:0:3==e?1:0))}return n}function s(r,t){return r<0||i<=r||t<0||f<=t?0:c[t][r]}function t(){a.clearRect(0,0,o,u);for(var r,t,e=0;e<f;e++)for(var n=0;n<i;n++)s(n,e)&&(r=n,t=e,a.fillStyle="#000",a.fillRect(r*$+v,t*$+v,l,l));c=h()}function e(){l=d($$("#size"),1,30),i=d($$("#col"),10,500),f=d($$("#row"),10,500),v=d($$("#margin"),0,30),o=($=2*v+l)*i,u=$*f,n.height=u,n.width=o,c=[];for(var r=0;r<f;r++){for(var t=[],e=0;e<i;e++)t.push(Math.round(Math.random()));c.push(t)}}function d(r,t,e){n=r.value;var n=parseInt(n);return r.value=e<(n=n<t?t:n)?e:n,e<n?e:n}function p(){r&&clearInterval(r),e(),r=setInterval(t,1e3/60)}n=$$("#life"),a=n.getContext("2d"),$$("#reset").addEvent("click",p);