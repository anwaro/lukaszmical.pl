THREE.OBJLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager,this.materials=null},THREE.OBJLoader.prototype={constructor:THREE.OBJLoader,load:function(e,n,t,i){var o=this,a=new THREE.XHRLoader(o.manager);a.setPath(this.path),a.load(e,function(e){n(o.parse(e))},t,i)},setPath:function(e){this.path=e},setMaterials:function(e){this.materials=e},parse:function(e){console.time("OBJLoader");var n=[],t=!1,i=[],o=[],a=[];function r(e){M={name:e,geometry:{vertices:[],normals:[],uvs:[]},material:{name:"",smooth:!0}},n.push(M)}function E(e){e=parseInt(e);return 3*(0<=e?e-1:e+i.length/3)}function h(e){e=parseInt(e);return 3*(0<=e?e-1:e+o.length/3)}function f(e){e=parseInt(e);return 2*(0<=e?e-1:e+a.length/2)}function w(e,n,t){M.geometry.vertices.push(i[e],i[e+1],i[e+2],i[n],i[n+1],i[n+2],i[t],i[t+1],i[t+2])}function p(e,n,t){M.geometry.normals.push(o[e],o[e+1],o[e+2],o[n],o[n+1],o[n+2],o[t],o[t+1],o[t+2])}function g(e,n,t){M.geometry.uvs.push(a[e],a[e+1],a[n],a[n+1],a[t],a[t+1])}function d(e,n,t,i,o,a,r,d,s,l,u,m){var c,e=E(e),n=E(n),t=E(t);void 0===i?w(e,n,t):(w(e,n,c=E(i)),w(n,t,c)),void 0!==o&&(e=f(o),n=f(a),t=f(r),void 0===i?g(e,n,t):(g(e,n,c=f(d)),g(n,t,c))),void 0!==s&&(e=h(s),n=h(l),t=h(u),void 0===i?p(e,n,t):(p(e,n,c=h(m)),p(n,t,c)))}r("");for(var s=/^v\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)/,l=/^vn\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)/,u=/^vt\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)/,m=/^f\s+(-?\d+)\s+(-?\d+)\s+(-?\d+)(?:\s+(-?\d+))?/,c=/^f\s+((-?\d+)\/(-?\d+))\s+((-?\d+)\/(-?\d+))\s+((-?\d+)\/(-?\d+))(?:\s+((-?\d+)\/(-?\d+)))?/,v=/^f\s+((-?\d+)\/(-?\d+)\/(-?\d+))\s+((-?\d+)\/(-?\d+)\/(-?\d+))\s+((-?\d+)\/(-?\d+)\/(-?\d+))(?:\s+((-?\d+)\/(-?\d+)\/(-?\d+)))?/,H=/^f\s+((-?\d+)\/\/(-?\d+))\s+((-?\d+)\/\/(-?\d+))\s+((-?\d+)\/\/(-?\d+))(?:\s+((-?\d+)\/\/(-?\d+)))?/,R=/^[og]\s+(.+)/,T=/^s\s+([01]|on|off)/,x=e.split("\n"),L=0;L<x.length;L++){var y,b=(b=x[L]).trim();if(0!==b.length&&"#"!==b.charAt(0))if(null!==(y=s.exec(b)))i.push(parseFloat(y[1]),parseFloat(y[2]),parseFloat(y[3]));else if(null!==(y=l.exec(b)))o.push(parseFloat(y[1]),parseFloat(y[2]),parseFloat(y[3]));else if(null!==(y=u.exec(b)))a.push(parseFloat(y[1]),parseFloat(y[2]));else if(null!==(y=m.exec(b)))d(y[1],y[2],y[3],y[4]);else if(null!==(y=c.exec(b)))d(y[2],y[5],y[8],y[11],y[3],y[6],y[9],y[12]);else if(null!==(y=v.exec(b)))d(y[2],y[6],y[10],y[14],y[3],y[7],y[11],y[15],y[4],y[8],y[12],y[16]);else if(null!==(y=H.exec(b)))d(y[2],y[5],y[8],y[11],void 0,void 0,void 0,void 0,y[3],y[6],y[9],y[12]);else if(null!==(y=R.exec(b))){var A=y[1].trim();!1===t?(t=!0,M.name=A):r(A)}else if(/^usemtl /.test(b))M.material.name=b.substring(7).trim();else if(!/^mtllib /.test(b)){if(null===(y=T.exec(b)))throw new Error("Unexpected line: "+b);M.material.smooth="1"===y[1]||"on"===y[1]}}for(var F=new THREE.Group,L=0,B=n.length;L<B;L++){var M,P,S=(M=n[L]).geometry,W=new THREE.BufferGeometry,S=(W.addAttribute("position",new THREE.BufferAttribute(new Float32Array(S.vertices),3)),0<S.normals.length?W.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(S.normals),3)):W.computeVertexNormals(),0<S.uvs.length&&W.addAttribute("uv",new THREE.BufferAttribute(new Float32Array(S.uvs),2)),(P=null!==this.materials?this.materials.create(M.material.name):P)||((P=new THREE.MeshPhongMaterial).name=M.material.name),P.shading=M.material.smooth?THREE.SmoothShading:THREE.FlatShading,new THREE.Mesh(W,P));S.name=M.name,F.add(S)}return console.timeEnd("OBJLoader"),F}};let e,t,i,o,n=0,a=0,r=window.innerWidth/2,d=window.innerHeight/2;function s(){r=window.innerWidth/2,d=window.innerHeight/2,t.aspect=window.innerWidth/window.innerHeight,t.updateProjectionMatrix(),o.setSize(window.innerWidth,window.innerHeight)}function l(e){n=(e.clientX-r)/2,a=(e.clientY-d)/2}{e=document.createElement("div"),document.body.appendChild(e),(t=new THREE.PerspectiveCamera(12,window.innerWidth/window.innerHeight,1,2e3)).position.z=30,i=new THREE.Scene;var u=new THREE.AmbientLight(1052720);i.add(u),(u=new THREE.DirectionalLight(16772829)).position.set(0,0,1),i.add(u),(u=new THREE.LoadingManager).onProgress=function(e,n,t){console.log(e,n,t)};let n=new THREE.Texture;new THREE.ImageLoader(u).load("/projects/car3d/image/UV_Grid_Sm.jpg",function(e){n.image=e,n.needsUpdate=!0}),new THREE.OBJLoader(u).load("/projects/car3d/image/gtr_1.obj",function(e){e.traverse(function(e){e instanceof THREE.Mesh&&(e.material.map=n)}),e.position.y=0,e.position.x=20,i.add(e)},function(e){e.lengthComputable&&console.log(Math.round(e.loaded/e.total*100,2)+"% downloaded")},function(e){}),(o=new THREE.WebGLRenderer).setPixelRatio(window.devicePixelRatio),o.setSize(window.innerWidth,window.innerHeight-100),e.appendChild(o.domElement),document.addEventListener("mousemove",l,!1),window.addEventListener("resize",s,!1)}!function e(){requestAnimationFrame(e),t.position.x=0,t.position.y=0,i.rotation.y+=.002,t.lookAt(i.position),o.render(i,t)}();