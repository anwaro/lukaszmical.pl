var canvasP,ctxP,canvasWidth=700,canvasHeight=500,mouseX=canvasWidth/2,mouseY=canvasHeight/2,num=20,r=5,f=.8,planets=[];function planet(){(canvasP=document.getElementById("planet")).height=canvasHeight,canvasP.width=canvasWidth,canvasP.addEventListener("mousemove",mousePoss),prepareP(),canvasP&&canvasP.getContext&&((ctxP=canvasP.getContext("2d")).fillStyle="rgb(0, 0, 0)",ctxP.fillRect(0,0,canvasWidth,canvasHeight),setInterval(drawP,1e3/60))}function mousePoss(t){var e=canvasP.getBoundingClientRect();mouseX=t.clientX-e.left,mouseY=t.clientY-e.top}function drawP(){ctxP.fillStyle="rgba(0, 0, 0, 0.05)",ctxP.fillRect(0,0,canvasWidth,canvasHeight),ctxP.beginPath(),ctxP.fillStyle="#17B70E",ctxP.arc(mouseX,mouseY,1,0,2*Math.PI),ctxP.fill();for(var t=0;t<num;t++){ctxP.beginPath(),ctxP.fillStyle=planets[t].color,ctxP.arc(planets[t].poss.x,planets[t].poss.y,planets[t].r,0,2*Math.PI),ctxP.fill(),planets[t].v.y+=.0981;var e=getForce(planets[t]);planets[t].v.x+=e.x,planets[t].v.y+=e.y,(planets[t].poss.x-planets[t].r+planets[t].v.x<=0||planets[t].poss.x+planets[t].r+planets[t].v.x>=canvasWidth)&&(planets[t].v.x*=-f),(planets[t].poss.y-planets[t].r+planets[t].v.y<=0||planets[t].poss.y+planets[t].r+planets[t].v.y>=canvasHeight)&&(planets[t].v.y*=-f),planets[t].poss.x+=planets[t].v.x,planets[t].poss.y+=planets[t].v.y}}function getForce(t){var e=distance(t.poss,{x:mouseX,y:mouseY}),n=-.15/e*e;return{x:n*(t.poss.x-mouseX)/e,y:n*(t.poss.y-mouseY)/e}}function distance(t,e){return"object"==typeof t&&"object"==typeof e?Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)):Math.abs(t-e)}function prepareP(){for(var t=0;t<num;t++)planets.push(new Planet(rand(2*r,canvasWidth)+r,rand(2*r,canvasHeight)+r,"rgb("+int(rand(255))+", "+int(rand(255))+", "+int(rand(255))+")",r))}function int(t){return parseInt(t)}function rand(t,e){return void 0===e&&(e=t,t=0),Math.random()*(e-t)+t}function Planet(t,e,n,a){this.poss=new Point(t,e),this.v=new Point(rand(1,3),rand(1,3)),this.r=a,this.color=n}function Point(t,e){this.x=t,this.y=e}function Record(t,e){return new _record(t,e)}planet(),_record=function(t,e){var n,a,s=[],o=[],r=0,c=function(){for(var t="",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;n<25;n++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}(),i=!0,l=!1,p="/projects/ajax";function u(){var t,e;l&&!i&&(s.push(n.toDataURL()),5<=s.length)&&(o.push(s),s=[],e=o.shift(),e={name:c,photo:e},console.log("PoszÅ‚a paczka nr "+r),e=e,(t=new XMLHttpRequest).onreadystatechange=function(){4===t.readyState&&200===t.status&&console.log("Zapisano paczke "+t.responseText)},t.open("POST",p,!0),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.send("data="+encodeURIComponent(JSON.stringify(e))+"&number="+r),r++)}this.start=function(){l||(l=!(i=!1),(new Date).getTime(),a=setInterval(u,100))},this.stop=function(){i=!(l=!1),clearInterval(a)},this.pause=function(){i=!0,clearInterval(a)},this.getVideo=function(){var t=new XMLHttpRequest;t.onreadystatechange=function(){4===t.readyState&&200===t.status&&console.log(t.responseText)},t.open("POST",p+"Video",!0),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.send("name="+c)},n=t};