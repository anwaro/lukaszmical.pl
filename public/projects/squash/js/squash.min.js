const Game={BlockWidth:50,BlockHeight:25,NumX:10,NumY:4,boardX:0,boardY:0,boardYwithMenu:0,MenuY:50,Score:0,Level:1,Life:3,pause:!0,NumTrance:70,titleFontSize:"bold 24px Georgia",MenuFontSize:"bold 20px Georgia"};Game.boardX=Game.BlockWidth*Game.NumX,Game.boardY=Game.BlockHeight*Game.NumY+300,Game.boardYwithMenu=Game.boardY+Game.MenuY;const Mouse={MouseX:Game.boardX/2,PrevMouse:0,PrevMouse2:0,dM:0,dM2:0},Bar={width:100,height:20,posX:160,posY:Game.boardYwithMenu-25};function Balls(a,e){this.posX=Game.boardX/2,this.posY=300,this.color=a,this.dX=Math.pow(-1,Math.ceil(10*Math.random())%10)*(3*Math.random()+2),this.dY=-9,this.radius=e}function Block(a,e){this.posX=a,this.posY=e,this.display=0}let canvas,ctx,gameLoop,x1,x2,y1,y2,MenuGradient,BoardGradient,BarGradient,Alfa=0;const BlockGradient=[],Trance=[],Area=[],Ball=new Balls("rgb(255,50,0)",9);for(var i=0;i<Game.NumTrance;i++)Trance[i]=new Balls("rgb(255,"+(80+i)+",0)",Ball.radius-(Ball.radius-1)/Game.NumTrance*(i+1));for(i=0;i<Game.NumX;i++){Area[i]=[];for(var j=0;j<Game.NumY;j++)Area[i][j]=new Block(i*Game.BlockWidth,j*Game.BlockHeight+Game.MenuY),Area[i][j].display=1}function init(){ResetGame(),canvas=document.getElementById("squash"),canvas.height=Game.boardYwithMenu,canvas.width=Game.boardX,canvas.getContext&&(ctx=canvas.getContext("2d"),MakeGradient(),gameLoop=setInterval(DrawAll,20),window.addEventListener("keydown",WhatKey,!0),canvas.addEventListener("mousemove",(function(a){WhereMouse(canvas,a)}),!1),canvas.addEventListener("click",(function(){Game.pause=!0}),!1))}function DrawAll(){if(Game.pause){ctx.clearRect(0,0,Game.boardX,Game.boardYwithMenu),ctx.fillStyle=BoardGradient,ctx.beginPath(),ctx.rect(0,0,Game.boardX,Game.boardYwithMenu),ctx.closePath(),ctx.fill(),ctx.fillStyle=MenuGradient,ctx.beginPath(),ctx.rect(0,0,Game.boardX,Game.MenuY),ctx.closePath(),ctx.fill(),DrawMenu(),y1=Bar.posY-Bar.width/2*Math.sin(Alfa),x1=Bar.posX+Bar.height/2-Bar.width/2,y2=Bar.posY+Bar.width/2*Math.sin(Alfa),x2=Bar.posX+Bar.width/2-Bar.height/2,ctx.beginPath(),ctx.moveTo(x1,y1),ctx.lineTo(x2,y2),ctx.lineWidth=Bar.height,ctx.strokeStyle=BarGradient,ctx.lineCap="round",ctx.stroke();for(var a=0;a<Game.NumX;a++)for(let e=0;e<Game.NumY;e++)Area[a][e].display>0&&(ctx.fillStyle=BlockGradient[Area[a][e].display],ctx.beginPath(),ctx.rect(Area[a][e].posX+1,Area[a][e].posY+1,Game.BlockWidth-2,Game.BlockHeight-2),ctx.closePath(),ctx.fill());for(a=Game.NumTrance-1;a>1;a--)ctx.beginPath(),ctx.arc(Trance[a].posX,Trance[a].posY,Trance[a].radius,0,2*Math.PI,!1),ctx.fillStyle=Trance[a].color,ctx.fill();ctx.beginPath(),ctx.arc(Ball.posX,Ball.posY,Ball.radius,0,2*Math.PI,!1),ctx.fillStyle=Ball.color,ctx.fill(),DrawMenu(),MoveBar(),MoveBall(),UpdateTrancePoss(),CheckStatus()}}function MakeGradient(){MenuGradient=ctx.createLinearGradient(0,0,0,Game.MenuY),MenuGradient.addColorStop(0,"#99BAEB"),MenuGradient.addColorStop(.5,"#0052CC"),MenuGradient.addColorStop(1,"#99BAEB"),BoardGradient=ctx.createLinearGradient(0,0,0,Game.boardYwithMenu),BoardGradient.addColorStop(0,"#AD8DEE"),BoardGradient.addColorStop(.4,"#68558F"),BoardGradient.addColorStop(1,"#AD8DEE"),BarGradient=ctx.createLinearGradient(0,Game.boardYwithMenu-30,0,Game.boardYwithMenu),BarGradient.addColorStop(0,"#FFA319"),BarGradient.addColorStop(.4,"#CC0000"),BarGradient.addColorStop(1,"#FFA319"),BlockGradient[1]=ctx.createLinearGradient(0,0,0,Game.BlockHeight*Game.NumY+Game.MenuY),BlockGradient[1].addColorStop(0,"yellow"),BlockGradient[1].addColorStop(.4,"orange"),BlockGradient[1].addColorStop(1,"yellow"),BlockGradient[2]=ctx.createLinearGradient(0,0,0,Game.BlockHeight*Game.NumY+Game.MenuY),BlockGradient[2].addColorStop(0,"red"),BlockGradient[2].addColorStop(.4,"brown"),BlockGradient[2].addColorStop(1,"red"),BlockGradient[3]=ctx.createLinearGradient(0,0,0,Game.BlockHeight*Game.NumY+Game.MenuY),BlockGradient[3].addColorStop(0,"brown"),BlockGradient[3].addColorStop(.4,"black"),BlockGradient[3].addColorStop(1,"brown")}function DrawMenu(){ctx.font=Game.MenuFontSize,ctx.fillStyle="white",ctx.fillText("Life: "+Game.Life,10,30),ctx.fillText("Level: "+Game.Level,Game.boardX/2-70,30),ctx.fillText("Score: "+Game.Score,Game.boardX-140,30)}function UpdateTrancePoss(){for(let a=Game.NumTrance-1;a>0;a--)Trance[a].posX=Trance[a-1].posX,Trance[a].posY=Trance[a-1].posY;Trance[0].posX=Ball.posX,Trance[0].posY=Ball.posY}function UpdateBlock(){if(Game.Level<4)for(let a=0;a<Game.NumX;a++)for(let e=0;e<Game.NumY;e++)Area[a][e].display=Game.Level}function ResetGame(){const a=document.querySelector("#PlayGame"),e=document.querySelector("#game");a&&(a.style.display="none",a.style.marginTop="140px",a.style.marginLeft=(Game.boardX-a.clientWidth)/2+"px",a.style.marginTop="200px"),e&&(e.style.width=Game.boardYwithMenu+"px",e.style.width=Game.boardX+"px"),UpdateBlock(),ResetBallPoss(),ResetTrancePoss(),Game.Life=3,Game.Score=0}function CheckStatus(){let a=!0;for(let e=0;e<Game.NumX;e++)for(let l=0;l<Game.NumY;l++)Area[e][l].display>0&&(a=!1);a&&NextLevel(),Game.Life<1&&GameEnd()}function NextLevel(){Game.Level++,Game.Life+=2,Game.Score+=10,UpdateBlock(),ResetBallPoss(),ResetTrancePoss(),Game.pause=!1,ctx.font=Game.titleFontSize,ctx.fillStyle="white",ctx.fillText("Press s to continue",(Game.boardX-240)/2,290)}function MoveBar(){Mouse.MouseX<Bar.width/2?Bar.posX=Bar.width/2:Mouse.MouseX>Game.boardX-Bar.width/2?Bar.posX=Game.boardX-Bar.width/2:Bar.posX=Mouse.MouseX}function MoveBall(){Ball.posX+=Ball.dX,Ball.posY+=Ball.dY,CheckCollision();const a=(y1-y2)/(x1-x2),e=y1-a*x1,l=Alfa/.35*.5;Ball.posY+Ball.radius>=Game.boardYwithMenu-60&&(Ball.posX>=x1-Bar.height/2&&Ball.posX<=x2+Bar.height/2&&Ball.posX*a+e-Bar.height/2<=Ball.posY+Ball.dY+Ball.radius&&Ball.dY>0&&(Alfa>0&&(Ball.dX>0?(Ball.dX=Ball.dX+l*Ball.dX,Ball.dY=-(Ball.dY-l*Ball.dY)):(Ball.dX=Ball.dX-l*Ball.dX,Ball.dY=-(Ball.dY+l*Ball.dY))),Alfa<0&&(Ball.dX>0?(Ball.dX=Ball.dX-l*Ball.dX,Ball.dY=-(Ball.dY+l*Ball.dY)):(Ball.dX=Ball.dX+l*Ball.dX,Ball.dY=-(Ball.dY-l*Ball.dY))),0===Alfa&&(Ball.dY=-Ball.dY)),Ball.posY+Ball.dY>Game.boardYwithMenu-2*Ball.radius&&(Game.Life--,ResetBallPoss(),ResetTrancePoss(),Game.pause=!1)),(Ball.posX+Ball.dX>Game.boardX-Ball.radius||Ball.posX+Ball.dX<Ball.radius)&&(Ball.dX=-Ball.dX),(Ball.posY+Ball.dY>Game.boardYwithMenu-Ball.radius||Ball.posY+Ball.dY<Game.MenuY+Ball.radius)&&(Ball.dY=-Ball.dY)}function ResetBallPoss(){Ball.dX=Math.pow(-1,Math.ceil(10*Math.random())%10)*(3*Math.random()+2),Ball.dY=-9,Ball.posX=Mouse.MouseX,Ball.posY=Bar.posY-2*Ball.radius}function ResetTrancePoss(){for(let a=Game.NumTrance-1;a>=0;a--)Trance[a].posX=Ball.posX,Trance[a].posY=Ball.posY}function CheckCollision(){for(let a=0;a<Game.NumX;a++)for(let e=0;e<Game.NumY;e++)Area[a][e].display>0&&(Ball.dY>0&&Ball.dX>0&&Area[a][e].posX<=Ball.posX+Ball.radius&&Ball.posX+Ball.radius<=Area[a][e].posX+Game.BlockWidth&&Area[a][e].posY<=Ball.posY+Ball.radius&&Ball.posY+Ball.radius<=Area[a][e].posY+Game.BlockHeight&&(Area[a][e].display--,Game.Score++,Area[a][e].posY<=Ball.posY&&Ball.posY<=Area[a][e].posY+Game.BlockHeight?Ball.dX=-Ball.dX:Ball.dY=-Ball.dY),Ball.dY>0&&Ball.dX<0&&Area[a][e].posX<=Ball.posX-Ball.radius&&Ball.posX-Ball.radius<=Area[a][e].posX+Game.BlockWidth&&Area[a][e].posY<=Ball.posY+Ball.radius&&Ball.posY+Ball.radius<=Area[a][e].posY+Game.BlockHeight&&(Area[a][e].display--,Game.Score++,Area[a][e].posY<=Ball.posY&&Ball.posY<=Area[a][e].posY+Game.BlockHeight?Ball.dX=-Ball.dX:Ball.dY=-Ball.dY),Ball.dY<0&&Ball.dX<0&&Area[a][e].posX<=Ball.posX-Ball.radius&&Ball.posX-Ball.radius<=Area[a][e].posX+Game.BlockWidth&&Area[a][e].posY<=Ball.posY-Ball.radius&&Ball.posY-Ball.radius<=Area[a][e].posY+Game.BlockHeight&&(Area[a][e].display--,Game.Score++,Area[a][e].posY<=Ball.posY&&Ball.posY<=Area[a][e].posY+Game.BlockHeight?Ball.dX=-Ball.dX:Ball.dY=-Ball.dY),Ball.dY<0&&Ball.dX>0&&Area[a][e].posX<=Ball.posX+Ball.radius&&Ball.posX+Ball.radius<=Area[a][e].posX+Game.BlockWidth&&Area[a][e].posY<=Ball.posY-Ball.radius&&Ball.posY-Ball.radius<=Area[a][e].posY+Game.BlockHeight&&(Area[a][e].display--,Game.Score++,Area[a][e].posY<=Ball.posY&&Ball.posY<=Area[a][e].posY+Game.BlockHeight?Ball.dX=-Ball.dX:Ball.dY=-Ball.dY))}function GameEnd(){clearInterval(gameLoop),ctx.font=Game.titleFontSize,ctx.fillStyle="white",ctx.fillText("GAME OVER",(Game.boardX-140)/2,290),$("#PlayGame").css("display","block")}function WhatKey(a){switch(a.keyCode){case 83:Game.pause=!0}}function WhereMouse(a,e){const l=a.getBoundingClientRect(),o=e.clientX-l.left;Mouse.PrevMouse2=Mouse.PrevMouse,Mouse.PrevMouse=Mouse.MouseX,Mouse.MouseX=o,Mouse.dM=Mouse.MouseX-Mouse.PrevMouse,Mouse.dM2=Mouse.PrevMouse-Mouse.PrevMouse2,Math.abs((Mouse.dM+Mouse.dM2)/2)>30&&(Mouse.dM=Math.abs((Mouse.dM+Mouse.dM2)/2)/((Mouse.dM+Mouse.dM2)/2)*30),Alfa=(Mouse.dM+Mouse.dM2)/2*3.14/180}init();